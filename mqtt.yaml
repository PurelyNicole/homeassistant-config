fan:
  - name: "Family Room Fan - South"
    qos: 1
    state_topic: "stat/family_room_south_fan/POWER"
    command_topic: "cmnd/family_room_south_fan/POWER"
    availability_topic: "tele/family_room_south_fan/LWT"
    percentage_state_topic: "stat/family_room_south_fan/speed"
    percentage_value_template: '{{ ((value | replace("3,","")) | int + 1) * 25 }}'
    percentage_command_topic: "cmnd/family_room_south_fan/tuyasend4"
    percentage_command_template: "3,{{ ((value | int - 1) / 25) | int }}"
    preset_mode_state_topic: "stat/family_room_south_fan/speed"
    preset_mode_value_template: '{{ value | replace("3,0", "turtle") | replace("3,1", "low") | replace("3,2", "medium") | replace("3,3", "high") }}'
    preset_mode_command_topic: "cmnd/family_room_south_fan/tuyasend4"
    preset_mode_command_template: '{{ value | replace("turtle", "3,0") | replace("low", "3,1") | replace("medium", "3,2") | replace("high", "3,3") }}'
    preset_modes:
      - "turtle"
      - "low"
      - "medium"
      - "high"
    payload_available: "Online"
    payload_not_available: "Offline"
    payload_on: "ON"
    payload_off: "OFF"
    unique_id: family_room_fan_south

light:
  # MJ Dimmers - These do not work well with Tasmota integration.
  - name: "Family Room Track Light - Back"
    state_topic: "stat/FamilyRoom_TrackLight_Back/POWER"
    command_topic: "cmnd/FamilyRoom_TrackLight_Back/POWER"
    availability_topic: "tele/FamilyRoom_TrackLight_Back/LWT"
    brightness_state_topic: "stat/FamilyRoom_TrackLight_Back/RESULT"
    brightness_command_topic: "cmnd/FamilyRoom_TrackLight_Back/Dimmer"
    brightness_scale: 100
    brightness_value_template: "{{ value_json.Dimmer }}"
    qos: 1
    payload_on: "ON"
    payload_off: "OFF"
    payload_available: "Online"
    payload_not_available: "Offline"
    retain: false
    unique_id: 807d3a3730e8
  - name: "Master Bath Light"
    state_topic: "stat/MB_Bath_Light/POWER"
    command_topic: "cmnd/MB_Bath_Light/POWER"
    availability_topic: "tele/MB_Bath_Light/LWT"
    brightness_state_topic: "stat/MB_Bath_Light/RESULT"
    brightness_command_topic: "cmnd/MB_Bath_Light/Dimmer"
    brightness_scale: 100
    brightness_value_template: "{{ value_json.Dimmer }}"
    qos: 1
    payload_on: "ON"
    payload_off: "OFF"
    payload_available: "Online"
    payload_not_available: "Offline"
    retain: false
    unique_id: master_bath_light
  - name: "Eric Office Light"
    state_topic: "stat/EricOfficeLight/POWER"
    command_topic: "cmnd/EricOfficeLight/POWER"
    availability_topic: "tele/EricOfficeLight/LWT"
    brightness_state_topic: "stat/EricOfficeLight/RESULT"
    brightness_command_topic: "cmnd/EricOfficeLight/Dimmer"
    brightness_scale: 100
    brightness_value_template: "{{ value_json.Dimmer }}"
    qos: 1
    payload_on: "ON"
    payload_off: "OFF"
    payload_available: "Online"
    payload_not_available: "Offline"
    retain: false
    unique_id: EricOfficeLight
  # Shelly Dimmers - Not autodiscoverable
  # Workbench LED Light
  - name: "Workbench LED Light"
    state_topic: "stat/workbench_led/POWER"
    command_topic: "cmnd/workbench_led/POWER"
    availability_topic: "tele/workbench_led/LWT"
    qos: 1
    payload_on: "ON"
    payload_off: "OFF"
    payload_available: "Online"
    payload_not_available: "Offline"
    retain: false
    unique_id: workbench_led_light

sensor:
  - name: "Energy Bridge"
    icon: mdi:home-lightning-bolt
    state_topic: "event/metering/summation/minute"
    unit_of_measurement: "W"
    value_template: "{{ value_json.value }}"
    state_class: total
    unique_id: energy_bridge
  - name: "Energy Bridge - Kwh" #Converts the W vaule int Kwh, for energy dashboard
    icon: mdi:home-lightning-bolt
    state_topic: "event/metering/summation/minute"
    unit_of_measurement: "kWh"
    value_template: "{{ value_json.value | float / 60000 }}"
    last_reset_value_template: "{{ now().fromtimestamp(value_json.time / 1000).replace(tzinfo=now().tzinfo) }}"
    device_class: energy
    state_class: total
    unique_id: energy_bridge_kwh
