- id: home_mode_away
  alias: Home Mode - Set away when everyone leaves
  description: When everyone leaves And 5 minutes have passed Then the Home Mode switches
    to Away
  trigger:
  - platform: state
    entity_id: group.people
    from: home
    to: not_home
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - service: input_select.select_option
    target:
      entity_id: input_select.home_mode
    data:
      option: Away
  - scene: scene.goodbye
  mode: parallel
  max: 10
- id: welcome_home
  alias: Welcome Home
  description: 'When someone arrives home: If state is not Sleep, set state to home.
    If it''s after sunset, turn on dining room light and globe lamp.'
  trigger:
  - platform: state
    entity_id: group.people
    to: home
  - platform: state
    entity_id: person.eric
    to: home
  - platform: state
    entity_id: person.nicole
    to: home
  condition: []
  action:
  - device_id: 35b0a2a05a9a45379fc7c5f05f6f57fd
    domain: lock
    entity_id: lock.kitchen_door_lock
    type: unlock
  - if:
    - condition: not
      conditions:
      - condition: state
        entity_id: input_select.home_mode
        state: Sleep
      alias: Mode is not Sleep
    then:
    - service: input_select.select_option
      data:
        option: Home
      target:
        entity_id: input_select.home_mode
    - service: switch.turn_on
      data: {}
      target:
        entity_id: switch.magic_mirror_screen
  - if:
    - condition: or
      conditions:
      - condition: sun
        after: sunset
        after_offset: '-1:00'
        before: sunrise
      - condition: template
        value_template: '{{states("sensor.pixel_post_light_power")|float > 0}}'
        alias: Pixel Post Light is on
    then:
    - type: turn_on
      device_id: 9dd57a98dd4307e523095748acd917f1
      entity_id: light.kitchen_mudroom_dimmer
      domain: light
      brightness_pct: 100
    - type: turn_on
      device_id: 35744bb4b80d36890ae0f34f1ad22a94
      entity_id: light.dining_room_table_dimmer
      domain: light
      brightness_pct: 100
    - type: turn_on
      device_id: b3275c0af7696dc2e67ed8b562004634
      entity_id: light.kitchen_table_light
      domain: light
      brightness_pct: 100
    - service: light.turn_on
      data: {}
      target:
        entity_id: light.den_stair_landing
  mode: parallel
  max: 10
- id: goodnight_2am
  alias: Scene - Goodnight at 2:00am
  description: When the time is 2:00am And Someone is home Then call the goodnight
    scene
  trigger:
  - platform: time
    at: 02:00:00
  condition:
  - condition: state
    entity_id: group.people
    state: home
  action:
  - scene: scene.goodnight
  mode: single
- id: lights_off_sunrise
  alias: Lighting - Turn lights off at sunrise
  description: When the sun rises Then turn off Outdoor Lights And Turn off the nightlight
  trigger:
  - platform: sun
    event: sunrise
    offset: '0'
  condition: []
  action:
  - type: turn_off
    device_id: 270c91f7718161af4127d8eb00d5cf32
    entity_id: light.nightlight
    domain: light
  - service: light.turn_off
    target:
      area_id: outdoors
    data: {}
  - service: light.turn_on
    data: {}
    target:
      entity_id: light.pixel_post_light
  mode: single
- id: watch_tv_after_sunset
  alias: Scene - Trigger watch TV when Remote goes from PowerOff after sunset
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: d824906b0d4aea07973580f026dc7ed9
    entity_id: remote.family_room_remote
    domain: remote
  condition:
  - condition: sun
    after: sunset
    after_offset: '-1:00'
  action:
  - scene: scene.watch_tv
  - service: scene.turn_on
    target:
      entity_id: scene.watch_tv_main_floor
    metadata: {}
  mode: single
- id: basement_lights_single_switch
  alias: Basement - Control lights with single switch
  description: When the basement light switch is toggled, change the state of the
    other lights to match.
  trigger:
  - platform: device
    type: changed_states
    device_id: efbcedf9dc139306d474e13da27929f3
    entity_id: light.basement_stairs_switch
    domain: light
  condition: []
  action:
  - choose:
    - conditions:
      - condition: device
        type: is_off
        device_id: efbcedf9dc139306d474e13da27929f3
        entity_id: light.basement_stairs_switch
        domain: light
      sequence:
      - service: light.turn_off
        data: {}
        target:
          area_id: basement
    - conditions:
      - condition: device
        type: is_on
        device_id: efbcedf9dc139306d474e13da27929f3
        entity_id: light.basement_stairs_switch
        domain: light
      sequence:
      - service: light.turn_on
        data: {}
        target:
          entity_id:
          - light.basement_landing_lights
          - light.basement_lights_north
          - light.basement_lights_south
    default: []
  mode: single
- id: nicole_office_motion
  alias: Nicole Office - Turn off lights when no one in office
  description: When no motion is detected in the Office And 5 minutes have passed
    Then turn off the lights
  trigger:
  - type: no_motion
    platform: device
    device_id: aa43c0bccd576d4987586522ab5fa9d3
    entity_id: binary_sensor.nicole_office_sensor_home_security_motion_detection
    domain: binary_sensor
    for:
      hours: 0
      minutes: 20
      seconds: 0
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.nicole_office_wall_switch
  mode: single
- id: sub_control_remote
  alias: Family Room - Control sub with remote
  description: When the remote turns on, turn on the sub.
  trigger:
  - platform: device
    type: changed_states
    device_id: d824906b0d4aea07973580f026dc7ed9
    entity_id: remote.family_room_remote
    domain: remote
  condition: []
  action:
  - choose:
    - conditions:
      - condition: device
        type: is_on
        device_id: d824906b0d4aea07973580f026dc7ed9
        entity_id: remote.family_room_remote
        domain: remote
      sequence:
      - type: turn_on
        device_id: a92e583bc2e9af0c7902a1cf6aca3a3e
        entity_id: switch.family_room_sub
        domain: switch
    - conditions:
      - condition: device
        type: is_off
        device_id: d824906b0d4aea07973580f026dc7ed9
        entity_id: remote.family_room_remote
        domain: remote
      sequence:
      - type: turn_off
        device_id: a92e583bc2e9af0c7902a1cf6aca3a3e
        entity_id: switch.family_room_sub
        domain: switch
    default: []
  mode: single
- id: notify_smoke_detected
  alias: Notification - Smoke Detector Activated
  description: ''
  trigger:
  - type: co
    platform: device
    device_id: 5dd20b9615b858ea31f5f02431fde004
    entity_id: binary_sensor.basement_smoke_detector_co_alarm_carbon_monoxide_detected
    domain: binary_sensor
  - type: smoke
    platform: device
    device_id: 5dd20b9615b858ea31f5f02431fde004
    entity_id: binary_sensor.basement_smoke_detector_smoke_alarm_smoke_detected
    domain: binary_sensor
  - type: co
    platform: device
    device_id: ac353f226d5faf78efe8bd287741ea47
    entity_id: binary_sensor.downstairs_smoke_detector_co_alarm_carbon_monoxide_detected
    domain: binary_sensor
  - type: smoke
    platform: device
    device_id: ac353f226d5faf78efe8bd287741ea47
    entity_id: binary_sensor.downstairs_smoke_detector_smoke_alarm_smoke_detected
    domain: binary_sensor
  - type: co
    platform: device
    device_id: 5dc7a5753d33064cf1c660f0097e0be2
    entity_id: binary_sensor.upstairs_smoke_detector_co_alarm_carbon_monoxide_detected
    domain: binary_sensor
  - type: smoke
    platform: device
    device_id: 5dc7a5753d33064cf1c660f0097e0be2
    entity_id: binary_sensor.upstairs_smoke_detector_smoke_alarm_smoke_detected
    domain: binary_sensor
  - type: smoke
    platform: device
    device_id: fe22124a5684619e2af2005c3afc93de
    entity_id: binary_sensor.workshop_smoke_and_carbon_monoxide_alarm_smoke_alarm_smoke_detected
    domain: binary_sensor
  - type: co
    platform: device
    device_id: 26b21ed8d1534bfcb780c21dd47b035f
    entity_id: binary_sensor.kitchen_smoke_detector_carbon_monoxide_detected
    domain: binary_sensor
  - type: smoke
    platform: device
    device_id: 26b21ed8d1534bfcb780c21dd47b035f
    entity_id: binary_sensor.kitchen_smoke_detector_smoke_detected
    domain: binary_sensor
  condition: []
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: Smoke detector has been activiated.
      title: Smoke Detector Activated!
      data:
        url: /lovelace/alarms
  mode: single
- id: master_bath_motion
  alias: Master Bathroom - Turn off lights when no motion detected
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.master_bathroom_sensor_home_security_motion_detection
    from: 'on'
    to: 'off'
    for:
      hours: 0
      minutes: 5
      seconds: 0
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      entity_id: light.master_bath_light
  mode: single
- id: vacation_lighting
  alias: Blueprint - Vacation Lighting
  description: ''
  use_blueprint:
    path: vacation_lighting.yaml
    input:
      vacation_mode_toggle: input_boolean.vacation_mode
      default_brightness: 100
      replay_sensor_1: sensor.replay_basement_lights
      light_target_1: group.basement_lights
      replay_sensor_2: sensor.replay_dining_room_dimmer
      light_target_2: light.dining_room_table_dimmer
      replay_sensor_3: sensor.replay_eric_office_light
      light_target_3: light.eric_office_light
      replay_sensor_4: sensor.replay_family_room_track_light_front
      light_target_4: group.family_room_lights
      replay_sensor_5: sensor.replay_garage_lights
      light_target_5: group.garage_lights
      replay_sensor_6: sensor.replay_kitchen_overhead_lights
      light_target_6: group.kitchen_lights
      replay_sensor_7: sensor.replay_living_room_wall_dimmer
      light_target_7: light.living_room_wall_dimmer
      replay_sensor_8: sensor.replay_kitchenette_spot_lights
      light_target_8: light.kitchenette_spot_lights
      replay_sensor_9: sensor.replay_master_bath_light
      light_target_9: light.master_bath_light
      replay_sensor_10: sensor.replay_nicole_office_lights
      light_target_10: light.nicole_office_wall_switch
- id: mini_cool_after_ride
  alias: Mini - Cool car after ride
  description: ''
  trigger:
  - platform: state
    entity_id:
    - device_tracker.cooper_se
    to: Hickory Glen
    for:
      hours: 0
      minutes: 40
      seconds: 0
  - platform: state
    entity_id:
    - device_tracker.cooper_se
    to: Milford Trail
    for:
      hours: 0
      minutes: 45
      seconds: 0
  - platform: state
    entity_id:
    - device_tracker.cooper_se
    to: Tree Farm
    for:
      hours: 0
      minutes: 45
      seconds: 0
  condition:
  - condition: template
    value_template: '{{state_attr("weather.ecobee_thermostat", "temperature") >= 70}}'
  action:
  - device_id: b7abdbf8fe525eb1a5ac7ea8fd050455
    domain: button
    entity_id: button.cooper_se_activate_air_conditioning
    type: press
  mode: single
- id: fish_tank_lights
  alias: Fish Lights and Feed
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: 0
  condition: []
  action:
  - type: turn_on
    device_id: a16dc6ccbdc67705acdb84885360d1f8
    entity_id: switch.fish_tank_lights
    domain: switch
  - type: turn_on
    device_id: e063d491c2a8f543fec0b738f8694367
    entity_id: switch.den_fish_feeder
    domain: switch
  - delay:
      hours: 5
      minutes: 0
      seconds: 0
      milliseconds: 0
  - type: turn_off
    device_id: a16dc6ccbdc67705acdb84885360d1f8
    entity_id: switch.fish_tank_lights
    domain: switch
  mode: single
- id: vacation_mode_auto
  alias: Vacation Mode
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_boolean.vacation_mode
    for:
      hours: 0
      minutes: 0
      seconds: 0
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_boolean.vacation_mode
        state: 'on'
      sequence:
      - device_id: afeb99ceb8a5bc6e7ae6e6af6eceee3b
        domain: climate
        entity_id: climate.family_room_thermostat
        type: set_hvac_mode
        hvac_mode: 'off'
        alias: Turn Family Room Thermostat Off
      - service: cover.close_cover
        metadata: {}
        data: {}
        target:
          entity_id: cover.all_shades
      - type: turn_off
        device_id: 527bcce84a0020ad4805403d7c88110a
        entity_id: 1b1ec3e92b573c166e96b68716ac16a3
        domain: switch
  mode: single
- id: nicole_office_lights_off
  alias: Nicole Office - Control lights with wall switch
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.nicole_office_wall_switch
    to: 'off'
    id: nicole_office_wall_switch_off
  - platform: state
    entity_id:
    - light.nicole_office_wall_switch
    to: 'on'
    id: nicole_office_wall_switch_on
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - nicole_office_wall_switch_off
      sequence:
      - service: light.turn_off
        data: {}
        target:
          area_id: nicole_office
    - conditions:
      - condition: trigger
        id:
        - nicole_office_wall_switch_on
      sequence:
      - service: light.turn_on
        data: {}
        target:
          device_id:
          - 84233bfe9142301d0caf5e3ba80fef60
          - 718d00abc7d9e96085a977f33b56e17e
  mode: restart
- id: niocole_office_closet_light
  alias: Nicole Office - Turn closet light off/on with door
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.nicole_office_closet_door
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.nicole_office_closet_door
        state: 'on'
      sequence:
      - type: turn_on
        device_id: 25520ab15610b01545d335b2672717a4
        entity_id: light.nicole_office_closet_light
        domain: light
    - conditions:
      - condition: state
        entity_id: binary_sensor.nicole_office_closet_door
        state: 'off'
      sequence:
      - type: turn_off
        device_id: 25520ab15610b01545d335b2672717a4
        entity_id: light.nicole_office_closet_light
        domain: light
  mode: single
- id: set_family_room_thermostat
  alias: Family Room Thermostat
  description: ''
  trigger:
  - platform: state
    entity_id:
    - climate.ecobee_thermostat
    attribute: temperature
  - platform: state
    entity_id:
    - climate.ecobee_thermostat
    to: heat
  - platform: state
    entity_id:
    - input_select.home_mode
    to: Sleep
  - platform: state
    entity_id:
    - input_select.home_mode
  - platform: time_pattern
    hours: /1
    alias: Every hour
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'off'
  action:
  - if:
    - condition: state
      entity_id: input_select.home_mode
      state: Sleep
    then:
    - device_id: afeb99ceb8a5bc6e7ae6e6af6eceee3b
      domain: climate
      entity_id: climate.family_room_thermostat
      type: set_hvac_mode
      hvac_mode: 'off'
      alias: Set thermostat to off
    else:
    - service: python_script.set_fr_thermostat
      data:
        main_thermostat: climate.ecobee_thermostat
        fr_thermostat: climate.family_room_thermostat
      alias: Set based on ecobee
  mode: restart
- id: notify_fish_feeder_offline
  alias: Notification - Notify when fish feeder goes offline
  description: ''
  trigger:
  - platform: state
    entity_id:
    - switch.den_fish_feeder
    to: unavailable
    for:
      hours: 0
      minutes: 1
      seconds: 0
  - platform: state
    entity_id:
    - switch.den_fish_feeder
    to: unknown
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - service: notify.mobile_app_nicole_iphone
    data:
      message: Fish tank feeder is offline.
  mode: single
- id: kitchette_leds_with_wall_switch
  alias: Kitchenette - Turn on LEDs with wall switch
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: 3a723969ea70edbaabb321ad14e6924d
    entity_id: light.kitchenette_spot_lights
    domain: light
  condition: []
  action:
  - type: turn_on
    device_id: 5cdd36d9da5933171ecacd4e048912ba
    entity_id: light.kitchenette_led_strip
    domain: light
  mode: single
- id: notify_oven_on
  alias: Notification - Everyone left or is sleeping but oven is on.
  description: ''
  trigger:
  - platform: state
    entity_id:
    - group.people
    to: away
  - platform: state
    entity_id:
    - input_select.home_mode
    to: Sleep
  condition:
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.oven_oven_machine_state
      state: ready
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: Oven is on.
  mode: single
- id: set_dte_peak_month
  alias: Set DTE Peak Month
  description: ''
  trigger:
  - platform: homeassistant
    event: start
  - platform: time
    at: 00:00:01
  condition: []
  action:
  - if:
    - condition: template
      value_template: '{{((now().month > 5) and (now().month < 10)) and (now().isoweekday()
        < 6)}}'
      alias: Current month is between June and September and it's a weekday
    then:
    - service: input_boolean.turn_on
      data: {}
      target:
        entity_id: input_boolean.dte_peak_season
    else:
    - service: input_boolean.turn_off
      data: {}
      target:
        entity_id: input_boolean.dte_peak_season
  mode: single
- id: notify_fridge_open
  alias: Notification - Upstairs fridge is open.
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 825c675de049294dc0a55919bdfbf156
    entity_id: binary_sensor.upstairs_refrigerator_door_open
    domain: binary_sensor
    for:
      hours: 0
      minutes: 2
      seconds: 0
  condition: []
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: 'Upstairs refridgerator is open. '
  mode: single
- id: mini_preconditon_after_work
  alias: Mini - Precondition after work.
  description: ''
  trigger:
  - platform: time
    at: '15:45:00'
  condition:
  - condition: or
    conditions:
    - condition: zone
      entity_id: device_tracker.cooper_se
      zone: zone.itc
    - condition: zone
      entity_id: device_tracker.cooper_se
      zone: zone.itc_ann_arbor
  action:
  - device_id: b7abdbf8fe525eb1a5ac7ea8fd050455
    domain: button
    entity_id: button.cooper_se_activate_air_conditioning
    type: press
  - device_id: b7abdbf8fe525eb1a5ac7ea8fd050455
    domain: lock
    entity_id: lock.cooper_se_lock
    type: unlock
  mode: single
- id: kitchen_window_seat_light
  alias: Kitchen - Control lights with overhead switch
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.kitchen_overhead_lights
    to: 'on'
    from: 'off'
  - platform: state
    entity_id:
    - light.kitchen_overhead_lights
    to: 'off'
    from: 'on'
  condition:
  - condition: not
    conditions:
    - condition: state
      entity_id: input_select.home_mode
      state: Sleep
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: light.kitchen_overhead_lights
        state: 'on'
      sequence:
      - service: light.turn_on
        data: {}
        target:
          area_id: kitchen
    - conditions:
      - condition: state
        entity_id: light.kitchen_overhead_lights
        state: 'off'
      sequence:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.kitchen_window_seat_light
  mode: queued
  max: 5
- id: notify_dishwasher_complete
  alias: 'Notification - Dishwasher finished '
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.dishwasher_operation_state
    to: Finished
    for:
      hours: 0
      minutes: 1
      seconds: 0
  condition: []
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: Dishwasher finished.
      data:
        url: /lovelace/chores
  mode: single
- id: notify_eric_left_work
  alias: Notification - Notify Nicole when Eric leaves work.
  description: ''
  trigger:
  - platform: zone
    entity_id: person.eric
    zone: zone.itc
    event: leave
  - platform: zone
    entity_id: person.eric
    zone: zone.itc_ann_arbor
    event: leave
  condition: []
  action:
  - service: notify.mobile_app_nicole_iphone
    data:
      message: Eric is leaving work.
  mode: single
- id: notify_water_detected
  alias: Notify when moisture sensor detects moisture
  description: ''
  trigger:
  - type: moist
    platform: device
    device_id: f1988841f3fd56b85b26e5b1cfcfccab
    entity_id: 959f8050e1559d76f127d4a303bae5db
    domain: binary_sensor
  - type: moist
    platform: device
    device_id: b98319a1990e48df55701f9bf318167c
    entity_id: binary_sensor.fish_tank_water_sensor
    domain: binary_sensor
  - type: moist
    platform: device
    device_id: 31e9606e62abd30bc5e6305603d8e67c
    entity_id: ba0bb7cf245fcdb75dd5c2468ace79e4
    domain: binary_sensor
  - type: moist
    platform: device
    device_id: 820f34bfa02aded8df58b18f667a8e29
    entity_id: 430f2ac6745f738cc321493f16595210
    domain: binary_sensor
  - type: moist
    platform: device
    device_id: 61a98c1c226600fd7f6dab560abf7f8b
    entity_id: 68c9965b29ab40584a13268141e23576
    domain: binary_sensor
  - type: moist
    platform: device
    device_id: 277c359a3c513cdd82f879b02205de11
    entity_id: cf265bad7fe9fbfbae4461256e6ad9b6
    domain: binary_sensor
  - type: moist
    platform: device
    device_id: 56da0d66327053ee3fe0cc28cd08925c
    entity_id: 87efdf059c8158bb6cad2d1334acd4e9
    domain: binary_sensor
  condition: []
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: '{{ trigger.to_state.attributes.friendly_name }} started detecting
        moisture.'
      url: /lovelace/alarms
  mode: single
- id: half_bath_lights_motion
  alias: Half Bath - Control lights with motion
  description: ''
  trigger:
  - type: motion
    platform: device
    device_id: 12b7dc73a4601643d79a3274b66d4c62
    entity_id: 23ec488c93780565cbf76d77209b40c4
    domain: binary_sensor
  - type: not_occupied
    platform: device
    device_id: 12b7dc73a4601643d79a3274b66d4c62
    entity_id: binary_sensor.half_bath_motion_sensor_occupancy
    domain: binary_sensor
  - type: no_motion
    platform: device
    device_id: 12b7dc73a4601643d79a3274b66d4c62
    entity_id: 23ec488c93780565cbf76d77209b40c4
    domain: binary_sensor
    for:
      hours: 0
      minutes: 10
      seconds: 0
  condition: []
  action:
  - choose:
    - conditions:
      - type: is_no_motion
        condition: device
        device_id: 12b7dc73a4601643d79a3274b66d4c62
        entity_id: 23ec488c93780565cbf76d77209b40c4
        domain: binary_sensor
        for:
          hours: 0
          minutes: 10
          seconds: 0
      sequence:
      - type: turn_off
        device_id: 10f945d73ec4f5a56d053445e3ef3f9b
        entity_id: light.half_bath_light
        domain: light
    - conditions:
      - type: is_occupied
        condition: device
        device_id: 12b7dc73a4601643d79a3274b66d4c62
        entity_id: binary_sensor.half_bath_motion_sensor_occupancy
        domain: binary_sensor
      sequence:
      - type: turn_on
        device_id: 10f945d73ec4f5a56d053445e3ef3f9b
        entity_id: light.half_bath_light
        domain: light
  mode: restart
- id: good_morning_nicole
  alias: Nicole - Good Morning Nicole
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_button.good_morning_nicole
    alias: When Good Morning Nicole button is pressed
  condition:
  - condition: state
    entity_id: person.nicole
    state: home
  action:
  - service: scene.turn_on
    target:
      entity_id: scene.good_morning
    metadata: {}
  - alias: Turn on Kitchen Table Light if before sunrise.
    if:
    - condition: sun
      before: sunrise
    then:
    - type: turn_on
      device_id: b3275c0af7696dc2e67ed8b562004634
      entity_id: light.kitchen_table_light
      domain: light
      brightness_pct: 100
  mode: single
- id: nicole_wind_down
  alias: Nicole - Wind Down
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_button.wind_down_nicole
    alias: When Wind Down Nicole Button is pressed
  condition:
  - condition: state
    entity_id: person.nicole
    state: home
  action:
  - service: scene.turn_on
    target:
      entity_id: scene.wind_down_nicole
    metadata: {}
  - service: climate.set_preset_mode
    data:
      preset_mode: sleep
    target:
      entity_id: climate.ecobee_thermostat
  mode: single
- id: good_morning_eric
  alias: Eric - Good Morning Eric
  description: ''
  trigger:
  - platform: state
    entity_id:
    - input_button.good_morning_eric
  condition:
  - condition: and
    conditions:
    - condition: not
      conditions:
      - condition: state
        entity_id: input_select.home_mode
        state: Home
      alias: Home Mode is not Home
    - condition: state
      entity_id: person.eric
      state: home
    alias: Home Mode is not Home and Eric is Home
  action:
  - service: scene.turn_on
    target:
      entity_id: scene.good_morning
    metadata: {}
  - service: scene.turn_on
    target:
      entity_id: scene.good_morning_eric
    metadata: {}
  mode: single
- id: garage_door_lights_with_door
  alias: Lighting - Turn on Garage Lights when Garage Door opens
  description: ''
  trigger:
  - platform: device
    device_id: 21959ccd3bcee083d4554dd0e553d051
    domain: cover
    entity_id: cover.garage_door
    type: opened
  condition:
  - condition: sun
    before: sunrise
    after: sunset
  action:
  - service: light.turn_on
    data: {}
    target:
      entity_id:
      - light.garage_lights_north
      - light.garage_lights_south
  mode: single
- id: mini_quota_workaround
  alias: MINI - Workaround for Quota
  description: ''
  trigger:
  - platform: time_pattern
    minutes: /15
  - platform: zone
    entity_id: person.nicole
    zone: zone.hickory_glen
    event: enter
  - platform: zone
    entity_id: person.nicole
    zone: zone.milford_trail
    event: enter
  - platform: zone
    entity_id: person.nicole
    zone: zone.tree_farm
    event: enter
  condition: []
  action:
  - service: homeassistant.update_entity
    data: {}
    target:
      entity_id: device_tracker.cooper_se
  mode: single
- id: hair_straightener_off_30_minutes
  alias: Hair Straightener - Turn off after 30 minutes
  description: ''
  trigger:
  - platform: device
    type: turned_on
    device_id: ca79eaed962b1a630ce3466878b3a0d0
    entity_id: switch.hair_straightener
    domain: switch
    for:
      hours: 0
      minutes: 30
      seconds: 0
  condition:
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.hair_straightener_energy_power
      state: '0'
  action:
  - type: turn_off
    device_id: ca79eaed962b1a630ce3466878b3a0d0
    entity_id: switch.hair_straightener
    domain: switch
  mode: single
- id: lighting_eric_office_no_motion
  alias: Lighting - Turn off Eric Office lights when no motion detected.
  description: ''
  trigger:
  - type: no_motion
    platform: device
    device_id: c129d1289ba41f785e7c3f9f3063173d
    entity_id: binary_sensor.eric_office_motion_sensor_motion
    domain: binary_sensor
    for:
      hours: 0
      minutes: 15
      seconds: 0
  condition: []
  action:
  - service: light.turn_off
    data: {}
    target:
      device_id: a286d07c98ea8f359f523bcc9d4c5cda
  mode: single
- id: notify_washing_machine_complete
  alias: Notification - Washing machine complete.
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.washing_machine
    from: 'on'
    to: 'off'
  condition:
  - condition: not
    conditions:
    - condition: time
      after: 00:00:00
      before: 08:00:00
    alias: It is not between Midnight and 8am
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: Washing machine cycle complete.
      data:
        url: /lovelace/chores
  mode: single
- id: set_ecobee_dte_update
  alias: Climate - Set Ecobee Thermostat
  description: ''
  trigger:
  - platform: state
    entity_id: binary_sensor.day
    to: 'on'
  - platform: state
    entity_id: binary_sensor.dusk
    to: 'on'
  - platform: state
    entity_id: binary_sensor.night
    to: 'on'
  - platform: state
    entity_id: input_select.home_mode
  - platform: state
    entity_id:
    - binary_sensor.windows
    enabled: true
  - platform: state
    entity_id:
    - schedule.dte_peak_hours
  - platform: state
    entity_id:
    - input_boolean.dte_peak_season
  - platform: time_pattern
    hours: /1
    alias: Every hour
  - platform: state
    entity_id:
    - climate.ecobee_thermostat
    from: unavailable
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'off'
  - condition: state
    entity_id: input_boolean.hvac_override
    state: 'off'
  action:
  - service: python_script.set_ecobee
    data:
      weather: weather.ecobee_thermostat
      thermostat: climate.ecobee_thermostat
  mode: restart
- id: notify_oven_preheated
  alias: Notification - Notify when oven is done preheating
  description: ''
  trigger:
  - platform: state
    entity_id:
    - sensor.oven_oven_job_state
    from: preheat
    to: cooking
  condition: []
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: Oven is preheated.
  mode: single
- id: lighting_basement_lights_with_door
  alias: Lighting - Turn on basement lights when door opened.
  description: ''
  trigger:
  - type: opened
    platform: device
    device_id: 14446959dbf188c58e6943d51605b8f2
    entity_id: binary_sensor.basement_door
    domain: binary_sensor
  - platform: state
    entity_id:
    - binary_sensor.basement_outside_door
    to: 'on'
  condition: []
  action:
  - service: light.turn_on
    data: {}
    target:
      device_id: efbcedf9dc139306d474e13da27929f3
  mode: single
- id: set_dimmers_max_during_day
  alias: Lighting - Set dimmers to max brightness when turned on during day.
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.dining_room_table_dimmer
    to: 'on'
    from: 'off'
    id: Dining Room Table Dimmer On
  - platform: state
    entity_id:
    - light.dining_room_wall_dimmer
    to: 'on'
    from: 'off'
    id: Dining Room Wall Dimmer On
  - platform: state
    entity_id:
    - light.fireplace_dimmer
    to: 'on'
    from: 'off'
    id: Fireplace Dimmer On
  - platform: state
    entity_id:
    - light.kitchen_mudroom_dimmer
    to: 'on'
    from: 'off'
    id: Kitchen Mudroom Dimmer On
  - platform: state
    entity_id:
    - light.kitchen_sink_dimmer
    to: 'on'
    from: 'off'
    id: Kitchen Sink Dimmer On
  - platform: state
    entity_id:
    - light.living_room_wall_dimmer
    from: 'off'
    to: 'on'
    id: Living Room Wall Dimmer On
  - platform: state
    entity_id:
    - light.kitchen_under_cabinet_lights
    from: 'off'
    to: 'on'
    id: Kitchen Under Cabinet Lights On
  - platform: state
    entity_id:
    - light.kitchen_table_light
    from: 'off'
    to: 'on'
    id: Kitchen Table Light On
  - platform: state
    entity_id:
    - light.family_room_track_light_back
    from: 'off'
    to: 'on'
    id: Family Room Track Light Back On
  - platform: state
    entity_id:
    - light.family_room_track_light_front
    from: 'off'
    to: 'on'
    id: Family Room Track Light Front On
  - platform: state
    entity_id:
    - light.kitchenette_led_strip
    from: 'off'
    to: 'on'
    id: Kitchenette LED Strip Lights On
  - platform: state
    entity_id:
    - light.kitchenette_spot_lights
    from: 'off'
    to: 'on'
    id: Kitchenette Spot Lights On
  - platform: state
    entity_id:
    - light.master_bath_light
    from: 'off'
    to: 'on'
    id: Master Bath Lights On
  - platform: state
    entity_id:
    - light.master_bedroom_light
    from: 'off'
    to: 'on'
    id: Master Bedroom Light On
  condition:
  - condition: or
    conditions:
    - condition: state
      entity_id: binary_sensor.day
      state: 'on'
    - condition: time
      after: 02:00:00
      before: 09:00:00
  action:
  - choose:
    - conditions:
      - condition: trigger
        id: Dining Room Table Dimmer
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.dining_room_table_dimmer
    - conditions:
      - condition: trigger
        id: Dining Room Wall Dimmer On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.dining_room_wall_dimmer
    - conditions:
      - condition: trigger
        id: Fireplace Dimmer On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.fireplace_dimmer
    - conditions:
      - condition: trigger
        id: Kitchen Mudroom Dimmer On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.kitchen_mudroom_dimmer
    - conditions:
      - condition: trigger
        id: Kitchen Sink Dimmer On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.kitchen_sink_dimmer
    - conditions:
      - condition: trigger
        id: Living Room Wall Dimmer On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.living_room_wall_dimmer
    - conditions:
      - condition: trigger
        id: Kitchen Under Cabinet Lights On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.kitchen_under_cabinet_lights
    - conditions:
      - condition: trigger
        id: Kitchen Table Light On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.kitchen_table_light
    - conditions:
      - condition: trigger
        id: Family Room Track Light Back On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.family_room_track_light_back
    - conditions:
      - condition: trigger
        id: Family Room Track Light Front On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.family_room_track_light_front
    - conditions:
      - condition: trigger
        id: Kitchenette LED Strip Lights On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.kitchenette_led_strip
    - conditions:
      - condition: trigger
        id: Kitchenette Spot Lights On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.kitchenette_spot_lights
    - conditions:
      - condition: trigger
        id: Master Bath Lights On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.master_bath_light
    - conditions:
      - condition: trigger
        id:
        - Master Bedroom Light On
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id:
          - light.master_bedroom_light
  mode: parallel
  max: 13
- id: notify_low_battery
  alias: Notification - Low battery level detection
  description: ''
  use_blueprint:
    path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
    input:
      actions:
      - service: notify.mobile_app_nicole_iphone
        data:
          message: Low battery detected for {{sensors}}.
          url: /lovelace/settings
      exclude:
        entity_id:
        - sensor.cooper_se_charging_level_hv
        - sensor.erics_ipad_battery_level
        - sensor.erics_iphone_14_battery_level
        - sensor.roomba_battery_level
        - sensor.roomba_mainfloor_battery_level
        - sensor.nicole_iphone_battery_level
      time: '11:00:00'
      threshold: 30
- id: vacation_mode_start_vacuum
  alias: Vacation - Vacuum at 8am
  description: ''
  trigger:
  - platform: time
    at: 08:00:00
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'on'
  action:
  - service: vacuum.start
    data: {}
    target:
      device_id:
      - b1393875f60de525a9a916b60d079b35
      - 0738239cc67de3bfc21e9424be3d5ae5
      - 18fc3eac9e0c2dd98544b84368340d91
  mode: single
- id: notify_lower_blinds_hvac
  alias: Cover - Put down blinds when HVAC is AC
  description: ''
  trigger:
  - platform: time
    at: '15:00:00'
  condition:
  - condition: and
    conditions:
    - condition: not
      conditions:
      - condition: device
        device_id: 80e2ea7676adeea018b6e96cb57a3af5
        domain: climate
        entity_id: climate.ecobee_thermostat
        type: is_hvac_mode
        hvac_mode: heat
        alias: Thermostat in heat mode
      - condition: time
        weekday:
        - sat
        - sun
  action:
  - if:
    - condition: state
      entity_id: binary_sensor.kitchen_window
      state: 'on'
    then:
    - service: cover.close_cover
      metadata: {}
      data: {}
      target:
        entity_id:
        - cover.living_room_shades_center_cover
        - cover.dining_room_shades_cover
    else:
    - service: cover.close_cover
      metadata: {}
      data: {}
      target:
        entity_id: cover.all_shades
  mode: single
- id: utility_lights_door
  alias: Lighting - Control utility room lights with door.
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.utility_room_doors
    to: 'on'
  - platform: state
    entity_id:
    - binary_sensor.utility_room_doors
    to: 'off'
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.utility_room_doors
        state: 'on'
      sequence:
      - type: turn_on
        device_id: 87cae5bef616e2da5f81d501bf1575ba
        entity_id: 957be681148125d3791991ccef10ea33
        domain: light
    - conditions:
      - condition: state
        entity_id: binary_sensor.utility_room_doors
        state: 'off'
      sequence:
      - type: turn_off
        device_id: 87cae5bef616e2da5f81d501bf1575ba
        entity_id: 957be681148125d3791991ccef10ea33
        domain: light
  mode: single
- id: lights_on_post_light
  alias: Outdoor Lights - Turn on with Pixel Post
  description: ''
  trigger:
  - platform: template
    value_template: '{{states("sensor.pixel_post_light_power")|float > 0}}'
    id: Pixel Post Light On
    alias: Pixel Post Light On
  - platform: template
    value_template: '{{states("sensor.pixel_post_light_power")|float == 0}}'
    id: Pixel Post Light Off
    alias: Pixel Post Light Off
    for:
      hours: 0
      minutes: 0
      seconds: 15
  condition:
  - condition: not
    conditions:
    - condition: time
      after: '21:30:00'
      before: sensor.sun_next_rising
      weekday:
      - mon
      - tue
      - wed
      - thu
      - fri
      - sat
      - sun
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - Pixel Post Light On
      sequence:
      - service: light.turn_on
        data: {}
        target:
          entity_id:
          - light.family_room_deck_light_side
          - light.outdoor_garage_lights
          - light.garage_flood_lights_west
          - light.service_door_light
          - light.porch_light
          - light.outside_workshop_light
          - light.driveway_post_and_tree_lights
      - choose:
        - conditions:
          - condition: template
            value_template: '{{(now().month == 10)}}'
            alias: If it's October...
          sequence:
          - service: light.turn_on
            data:
              rgb_color:
              - 165
              - 0
              - 255
              brightness: 255
            target:
              entity_id:
              - light.rgb_flood1
              - light.rgb_flood2
        - conditions:
          - alias: If it's December and Before Christmas...
            condition: template
            value_template: '{{((now().month == 12) and (now().day < 26))}}'
          sequence:
          - service: light.turn_on
            data:
              brightness: 255
              color_name: red
            target:
              entity_id:
              - light.rgb_flood1
          - service: light.turn_on
            data:
              color_name: green
              brightness: 255
            target:
              entity_id: light.rgb_flood2
        - conditions:
          - condition: template
            value_template: '{{((now().month == 10) == false) and (((now().month ==
              12) and (now().day > 26)) == false)}}'
            alias: If it's any other time...
          sequence:
          - service: light.turn_on
            data:
              kelvin: 3200
              brightness: 133
            target:
              entity_id:
              - light.rgb_flood1
              - light.rgb_flood2
    - conditions:
      - condition: trigger
        id:
        - Pixel Post Light Off
      sequence:
      - service: light.turn_off
        data: {}
        target:
          entity_id:
          - light.family_room_deck_light_side
          - light.outdoor_garage_lights
          - light.garage_flood_lights_west
          - light.service_door_light
          - light.porch_light
          - light.outside_workshop_light
          - light.driveway_post_and_tree_lights
          - light.rgb_flood1
          - light.rgb_flood2
  mode: single
- id: den_lights_wall_switch
  alias: Lighting - Control Den Step Lights with Wall Switch
  description: ''
  trigger:
  - platform: state
    entity_id:
    - light.den_stair_landing
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: light.den_stair_landing
        state: 'on'
      sequence:
      - service: light.turn_on
        data:
          brightness: 255
        target:
          entity_id: light.step_lights
    - conditions:
      - condition: and
        conditions:
        - condition: state
          entity_id: light.den_stair_landing
          state: 'off'
        - condition: device
          type: is_off
          device_id: d824906b0d4aea07973580f026dc7ed9
          entity_id: 8f28b37a84c7fecd099d5dca969d7974
          domain: remote
      sequence:
      - service: light.turn_off
        data: {}
        target:
          entity_id: light.step_lights
  mode: single
- id: kitchen_speakers_airplay
  alias: Kitchen - MuiscCast speakers to kitchen when source is airplay.
  description: ''
  trigger:
  - platform: state
    entity_id:
    - media_player.main_floor_musiccast
    attribute: source
    id: MainFloorMusicCastAirplay
    to: AirPlay
  - platform: state
    entity_id:
    - media_player.main_floor_musiccast
    attribute: source
    id: MainFloorMusicCastNotAirplay
    from: AirPlay
  condition: []
  action:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - MainFloorMusicCastAirplay
      sequence:
      - type: turn_off
        device_id: fd7ae8ebda3faafe21c87fe16cd3070c
        entity_id: cf8b4b8ca77b5f0c6f69b8bd94277650
        domain: switch
      - type: turn_on
        device_id: fd7ae8ebda3faafe21c87fe16cd3070c
        entity_id: bbdd762dcdb29668bcc8a8113aa7f587
        domain: switch
    - conditions:
      - condition: trigger
        id:
        - MainFloorMusicCastNotAirplay
      sequence:
      - type: turn_on
        device_id: fd7ae8ebda3faafe21c87fe16cd3070c
        entity_id: cf8b4b8ca77b5f0c6f69b8bd94277650
        domain: switch
      - type: turn_off
        device_id: fd7ae8ebda3faafe21c87fe16cd3070c
        entity_id: bbdd762dcdb29668bcc8a8113aa7f587
        domain: switch
  mode: single
- id: '1709577057770'
  alias: Lighting - Turn off bedroom closet light with overhead light
  description: ''
  trigger:
  - platform: device
    type: turned_off
    device_id: eaa06b0699424ef42111fb9c99d08b51
    entity_id: 6995b68a83031b1f5f85ae383883c5d7
    domain: light
  condition: []
  action:
  - service: light.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: light.master_bedroom_closet
  mode: single
- id: '1712235457271'
  alias: Notify - Workshop lock jammed
  description: ''
  trigger:
  - platform: device
    device_id: 2bc75cb02bff7d6fe5c4794fe89e99da
    domain: lock
    entity_id: c899559e86684ccf953a6e0ed5ad0169
    type: jammed
  condition: []
  action:
  - service: notify.notify_nicole_and_eric
    data:
      message: Issue with Workshop Lock. Check if door is closed.
      data:
        url: /lovelace/doors-and-windows
  mode: single
- id: '1713967151104'
  alias: Turn on Lava Lamp on Eric WFH Days
  description: ''
  trigger:
  - platform: time
    at: 04:00:00
  condition:
  - condition: state
    state: 'on'
    entity_id: binary_sensor.eric_at_home_workday_sensor
  action:
  - type: turn_on
    device_id: 310e0e6bf98c0b9f552045d210041997
    entity_id: 7b37168b4cb27af7e41d574a963a1197
    domain: switch
  mode: single
- id: '1713967270254'
  alias: Turn Off Lava Lamp at 4:00PM
  description: ''
  trigger:
  - platform: time
    at: '16:00:00'
  condition: []
  action:
  - type: turn_off
    device_id: 310e0e6bf98c0b9f552045d210041997
    entity_id: 7b37168b4cb27af7e41d574a963a1197
    domain: switch
  mode: single
- id: '1717264432700'
  alias: Cover - Open shades when sun sets
  description: ''
  trigger:
  - platform: sun
    event: sunset
    offset: 0
  - platform: time
    at: '19:00:00'
  condition:
  - condition: state
    entity_id: input_boolean.vacation_mode
    state: 'off'
  action:
  - service: cover.open_cover
    metadata: {}
    data: {}
    target:
      entity_id: cover.all_shades
  mode: single
- id: '1719534522240'
  alias: Turn Off Dehumidifiers and turn up fan during peak hours
  description: ''
  trigger:
  - platform: state
    entity_id:
    - schedule.dte_peak_hours
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: schedule.dte_peak_hours
        state: 'on'
      sequence:
      - type: turn_off
        device_id: 3a53683188654a1d7626ff893117c84e
        entity_id: d38be84d36d295254ee6042589bff0e9
        domain: switch
      - service: fan.set_percentage
        metadata: {}
        data:
          percentage: 100
        target:
          entity_id: fan.master_bedroom_fan
    - conditions:
      - condition: state
        entity_id: schedule.dte_peak_hours
        state: 'off'
      - condition: state
        entity_id: binary_sensor.windows
        state: 'off'
      sequence:
      - type: turn_on
        device_id: 3a53683188654a1d7626ff893117c84e
        entity_id: d38be84d36d295254ee6042589bff0e9
        domain: switch
      - service: fan.set_percentage
        metadata: {}
        data:
          percentage: 25
        target:
          entity_id: fan.master_bedroom_fan
  mode: single
- id: '1719773372343'
  alias: Dehumidifier - Turn off when windows open
  description: ''
  trigger:
  - platform: state
    entity_id:
    - binary_sensor.windows
  condition: []
  action:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.windows
        state: 'on'
      sequence:
      - type: turn_off
        device_id: 3a53683188654a1d7626ff893117c84e
        entity_id: d38be84d36d295254ee6042589bff0e9
        domain: switch
    - conditions:
      - condition: state
        entity_id: binary_sensor.windows
        state: 'off'
      sequence:
      - type: turn_on
        device_id: 3a53683188654a1d7626ff893117c84e
        entity_id: d38be84d36d295254ee6042589bff0e9
        domain: switch
  mode: single
- id: '1720812976067'
  alias: Turn off Main Floor TV with MusicCast
  description: ''
  trigger:
  - platform: device
    device_id: fd7ae8ebda3faafe21c87fe16cd3070c
    domain: media_player
    entity_id: ba2ee0936469db5b23a0def4b2183286
    type: turned_off
  condition: []
  action:
  - delay:
      hours: 0
      minutes: 0
      seconds: 3
      milliseconds: 0
  - type: turn_off
    device_id: 527bcce84a0020ad4805403d7c88110a
    entity_id: 1b1ec3e92b573c166e96b68716ac16a3
    domain: switch
  mode: single
- id: '1722293989725'
  alias: Notify on doorbell ring.
  description: ''
  trigger:
  - type: turned_on
    platform: device
    device_id: 763791b3c6dd38ebe82dd8ea919cce99
    entity_id: 07249e572542f3ad36721694f4b90fcf
    domain: binary_sensor
  condition: []
  action:
  - service: camera.snapshot
    target:
      entity_id: camera.doorbell_fluent
    data:
      filename: /config/www/doorbell/{{ expand('binary_sensor.doorbell_visitor')[0].last_changed
        | as_timestamp  | timestamp_custom("%Y-%m-%d_%H-%M-%S") }}.jpg
  - service: notify.notify_nicole_and_eric
    data:
      data:
        attachment:
          content-type: jpg
          hide-thumbnail: false
          url: /local/doorbell/{{ expand('binary_sensor.doorbell_visitor')[0].last_changed
            | as_timestamp  | timestamp_custom("%Y-%m-%d_%H-%M-%S") }}.jpg
        url: /lovelace/cameras
      message: Someone is at the front door.
    enabled: true
  - service: notify.persistent_notification
    metadata: {}
    data:
      message: '![image](/local/doorbell/{{ expand(''binary_sensor.doorbell_visitor'')[0].last_changed
        | as_timestamp  | timestamp_custom("%Y-%m-%d_%H-%M-%S") }}.jpg)'
      title: Someone is at the door.
  mode: single
- id: '1722441545108'
  alias: Notify on package delivery
  description: ''
  trigger:
  - type: turned_on
    platform: device
    device_id: 763791b3c6dd38ebe82dd8ea919cce99
    entity_id: 7b4332b28910776392a67484de7b974e
    domain: binary_sensor
  condition: []
  action:
  - service: notify.notify_nicole_and_eric
    metadata: {}
    data:
      message: 'A package has been delivered. '
      data:
        url: /lovelace/cameras
  mode: single
- id: '1722870045891'
  alias: Switch Master Bedroom Fan Direction with HVAC Mode
  description: ''
  trigger:
  - platform: device
    device_id: 80e2ea7676adeea018b6e96cb57a3af5
    domain: climate
    entity_id: 54b1fea52a0a813e5b05b1655dfba00b
    type: hvac_mode_changed
    to: heat
    alias: Ecobee Changes to Heat
  - platform: device
    device_id: 80e2ea7676adeea018b6e96cb57a3af5
    domain: climate
    entity_id: 54b1fea52a0a813e5b05b1655dfba00b
    type: hvac_mode_changed
    to: cool
    alias: Ecobee Changes to Cool
  condition: []
  action:
  - choose:
    - conditions:
      - condition: device
        device_id: 80e2ea7676adeea018b6e96cb57a3af5
        domain: climate
        entity_id: 54b1fea52a0a813e5b05b1655dfba00b
        type: is_hvac_mode
        hvac_mode: cool
        alias: Ecobee is Cooling
      sequence:
      - service: fan.set_direction
        metadata: {}
        data:
          direction: reverse
        target:
          entity_id: fan.master_bedroom_fan
        alias: Set fan to reverse
      alias: When Ecobee is cooling switch fan to reverse
    - conditions:
      - condition: device
        device_id: 80e2ea7676adeea018b6e96cb57a3af5
        domain: climate
        entity_id: 54b1fea52a0a813e5b05b1655dfba00b
        type: is_hvac_mode
        hvac_mode: heat
        alias: Ecobee is Heating
      sequence:
      - alias: Set bedroom fan to forward
        service: fan.set_direction
        metadata: {}
        data:
          direction: forward
        target:
          entity_id: fan.master_bedroom_fan
      alias: When Ecobee is heating switch fan to forward
  mode: single
